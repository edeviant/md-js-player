!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.mdPlayer=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){var mustache=require("mustache"),c$=require("cash-dom"),jsonp=require("jsonp"),audio5=require("audio5"),fa_tag=document.createElement("link");fa_tag.setAttribute("rel","stylesheet"),fa_tag.setAttribute("href","https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(fa_tag);var css_tag=document.createElement("link");css_tag.setAttribute("rel","stylesheet"),css_tag.setAttribute("href","dist/md-player.css"),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(css_tag);var myScript=(document.scripts,document.scripts[document.scripts.length-1]);if(c$(myScript).attr("data-playlist-id")||c$(myScript).attr("data-song-id")){var myDiv='<div class="md-player" data-playlist-id="'+c$(myScript).attr("data-playlist-id")+'" data-song-id="'+c$(myScript).attr("data-song-id")+'" data-template-id="'+c$(myScript).attr("data-template-id")+'"></div>';document.write(myDiv)}c$().ready(function(){var sec_to_time=function(p){var sec=Math.ceil(+p%60),min=Math.floor(+p/60);return sec=10>sec?"0"+sec:sec,min=10>min?"0"+min:min,min+":"+sec},api_url="https://xw9883y6af.execute-api.us-east-1.amazonaws.com/production/",templates={"md-player-simple-style":'<div class="media md-player-body">[[ #song ]]<div class="media-left"><div class="play-img-wrap md-play"><img src="[[song.artist.profile_pic_90_url]]" class="img-rounded artist-image"><i class="fa fa-play play-pause-icon play-icon" aria-hidden="true"></i><i class="fa fa-pause play-pause-icon pause-icon" aria-hidden="true"></i></div></div><div class="media-body"><h3 class="media-heading"><strong>[[ song.title ]]</strong> <small>by</small> [[ song.artist.name ]] <small><span class="elapsed">[[ elapsed ]]</span> - [[ song.duration_formatted ]]</small></h3><div class="audio-player"><div class="player-progress"><div class="loaded-container"></div><div class="played-container"></div><div class="waveform-container"></div></div></div></div>[[ /song ]][[ #playlist ]]<div class="md-player-playlist"><ul>[[ #songs ]]<li class="md-playlist-item" data-song-id="[[id]]"><img src="[[artist.profile_pic_90_url]]" width="20" height="20" alt=""><strong>[[ title ]]</strong> <small>by</small> [[ artist.name ]] &mdash; [[ duration_formatted ]]</li>[[ /songs ]]</ul></div>[[ /playlist ]]</div>',"md-player-sc-style":'<div class="media md-player-body">[[ #song ]]<div class="md-now-playing"><div class="md-track-image md-play-button md-play" style="background: transparent url([[song.artist.profile_pic_200_url]]) 50% 50% no-repeat; background-size: cover;"><i class="fa fa-play md-play-pause-icon md-play-icon" aria-hidden="true"></i><i class="fa fa-pause md-play-pause-icon md-pause-icon" aria-hidden="true"></i></div><div class="md-title-artist"><span class="md-artist-name">[[ song.artist.name ]]</span><br><span class="md-song-title">[[ song.title ]]</span></div><div class="player-progress"><div class="played-container"></div><div class="waveform-container"></div><div class="loaded-container"></div></div><div class="md-player-timing"><span class="elapsed">[[ elapsed ]]</span> - [[ song.duration_formatted ]]</div></div>[[ /song ]][[ #playlist ]]<div class="md-player-playlist"><ul class="md-playlist-container">[[ #songs ]]<li class="md-playlist-item" data-song-id="[[id]]"><div class="md-track-image" style="background-image: url([[artist.profile_pic_90_url]]);"></div><span class="md-song-title">[[ title ]]</span> &ndash; <span class="md-artist-name">[[ artist.name ]]</span> &ndash; <span class="md-song-duration">[[ duration_formatted ]]</span></li>[[ /songs ]]</ul></div>[[ /playlist ]]</div>'},$current_player=null,playOnLoad=!1,startAtZero=!1,audio=new audio5({swf_path:"/audio5js/audio5js.swf",format_time:!1});audio.on("load",function(){}),audio.on("play",function(){$current_player.find(".md-play"),c$(".is-playing").removeClass("is-playing"),$current_player.addClass("is-playing")}),audio.on("pause",function(){$current_player.removeClass("is-playing"),$current_player.find(".md-play")}),audio.on("canplay",function(){startAtZero&&(audio.seek(0),startAtZero=!1),audio.play()}),audio.on("timeupdate",function(position,duration){$current_player.find(".played-container").css("width",position/duration*100+"%"),$current_player.find(".elapsed").text(sec_to_time(position))}),audio.on("progress",function(load_percent){$current_player.find(".loaded-container").css("width",load_percent+"%")}),audio.on("ended",function(){playNextPrevSong($current_player)}),audio.on("error",function(){});var loadSongInPlayer=function(el,songId){var plOffset,template_style=c$(el).attr("data-template-id")||"md-player-sc-style"||"md-player-simple-style",t=templates[template_style];c$(el).addClass(template_style),jsonp(api_url+"song/"+songId,{},function(err,resp){if(resp){var data={};data.song=resp,data.elapsed="00:00",c$(el).data("song",data.song),(cti=c$(el).attr("data-template-id"))&&c$("#"+cti)[0]&&(t=c$("#"+cti).html()),data.song.duration_formatted=sec_to_time(data.song.duration),data.song.title=data.song.title.length>40?data.song.title.substring(0,40).trim()+"...":data.song.title,data.playlist=c$(el).data("playlist"),data.playlist&&c$(el).find(".md-playlist-container").get(0)&&(plOffset=c$(el).find(".md-player-playlist").get(0).scrollTop),mustache.parse(t,["[[","]]"]),c$(el).html(mustache.render(t,data)),plOffset&&(c$(el).find(".md-player-playlist").get(0).scrollTop=plOffset),playOnLoad&&(playOnLoad=!1,startAtZero=!0,$current_player=c$(el).closest(".md-player"),audio.load("http:"+data.song.media.streaming+".mp3"));var waveformWidth=c$(el).eq(0).find(".waveform-container").width(),q={color:{fg:"BE3026",bg:""},bar_width:2,bar_gap:1,filename:"waveform.json",vertical_align:!1,song_id:data.song.id,artist_sku:data.song.artist.sku,catalog_slug:data.song.media.streaming.split("/").filter(function(v){return""!==v})[1],size:{height:55,width:waveformWidth}};if(!(q.size.width<1)){var waveformUrlParams="?bar_width="+q.bar_width+"&artist_sku="+q.artist_sku+"&catalog_slug="+q.catalog_slug+"&bar_gap="+q.bar_gap+"&filename="+q.filename+"&vertical_align="+q.vertical_align+"&song_id="+q.song_id+"&size="+q.size.width;jsonp(api_url+"song/waveform"+waveformUrlParams,{},function(err,waveData){if(waveData){for(var waveformDOM='<div class="md-wf-container" style="height: '+q.size.height+"px; width: "+q.size.width+'px;">',i=0;i<waveData.peaks.length;i++){var bottom_margin=q.vertical_align?(q.size.height-Math.ceil(waveData.peaks[i]*(q.size.height/100)))/2+"px":0;waveformDOM+='<div class="md-wf-bar" style="margin-bottom: '+bottom_margin+"; width: "+q.bar_width+"px; height: "+Math.ceil(waveData.peaks[i]*(q.size.height/100))+"px; margin-left: "+q.bar_gap+'px;"></div>'}waveformDOM+="</div>",c$(el).find(".waveform-container").html(waveformDOM),c$(el).find(".played-container").html(waveformDOM)}})}}})},loadPlaylistInPlayer=function(el,playlistId){playlistId&&jsonp(api_url+"playlist/"+playlistId,{},function(err,resp){var data={};data.playlist=resp;for(var i=0;i<data.playlist.songs.length;i++)data.playlist.songs[i].duration_formatted=sec_to_time(data.playlist.songs[i].duration);c$(el).data("playlist",data.playlist),loadSongInPlayer(el,data.playlist.songs[0].id)})},playNextPrevSong=function(el,prev){if(prev);else if($current_player.hasClass("has-playlist"))for(var currentSongID=$current_player.data("song").id,items=$current_player.find(".md-playlist-item"),i=0;i<items.length;i++)if(c$(items[i]).attr("data-song-id")==currentSongID&&c$(items[i+1]).get(0)){playOnLoad=!0,loadSongInPlayer($current_player,c$(items[i+1]).attr("data-song-id"));break}};c$(".md-player").each(function(el){c$(el).attr("data-init")||(+c$(el).attr("data-playlist-id")?(c$(el).addClass("has-playlist"),loadPlaylistInPlayer(el,c$(el).attr("data-playlist-id"))):c$(el).attr("data-song-id")&&loadSongInPlayer(el,c$(el).attr("data-song-id")),c$(el).get(0).addEventListener("click",function(e){if(e.target&&"player-progress"==e.target.className){var $prev_player=$current_player;$current_player=c$(this).closest(".md-player");var p=e.offsetX/c$(e.target).width();if($prev_player&&$prev_player.data("song").id==$current_player.data("song").id)try{audio.seek(p*audio.duration)}catch(e){}else{audio.load("http:"+$current_player.data("song").media.streaming+".mp3");try{audio.seek(p*$current_player.data("song").duration)}catch(e){}}}}),c$(el).on("click",".md-play",function(){var $prev_player=$current_player;if($current_player=c$(this).closest(".md-player"),$prev_player&&$prev_player.data("song").id==$current_player.data("song").id)try{audio.playPause()}catch(e){}else startAtZero=!0,audio.load("http:"+$current_player.data("song").media.streaming+".mp3")}).on("click",".md-playlist-item",function(){c$(this).attr("data-song-id")&&(playOnLoad=!0,startAtZero=!0,loadSongInPlayer(c$(this).closest(".md-player"),c$(this).attr("data-song-id")))}).on("click",".player-progress",function(){}),c$(el).attr("data-init",!0))})})},{audio5:2,"cash-dom":3,jsonp:6,mustache:8}],2:[function(require,module){!function($win,ns,factory){"use strict";"undefined"!=typeof module&&module.exports?module.exports=factory(ns,$win):"function"==typeof define&&define.amd?define(function(){return factory(ns,$win)}):$win[ns]=factory(ns,$win)}(window,"Audio5js",function(ns,$win){"use strict";function AudioError(message){this.message=message}function cloneObject(obj){var i,clone={};for(i in obj)clone[i]="object"==typeof obj[i]?cloneObject(obj[i]):obj[i];return clone}var ActiveXObject=$win.ActiveXObject;AudioError.prototype=new Error;var extend=function(target,mixin){var name,m=cloneObject(mixin);for(name in m)m.hasOwnProperty(name)&&(target[name]=m[name]);return target},include=function(target,mixin){return extend(target.prototype,mixin)},Pubsub={on:function(evt,fn,ctx){this.subscribe(evt,fn,ctx,!1)},one:function(evt,fn,ctx){this.subscribe(evt,fn,ctx,!0)},off:function(evt,fn){if(void 0!==this.channels[evt]){var i,l;for(i=0,l=this.channels[evt].length;l>i;i++){var sub=this.channels[evt][i].fn;if(sub===fn){this.channels[evt].splice(i,1);break}}}},subscribe:function(evt,fn,ctx,once){void 0===this.channels&&(this.channels={}),this.channels[evt]=this.channels[evt]||[],this.channels[evt].push({fn:fn,ctx:ctx,once:once||!1})},trigger:function(evt){if(this.channels&&this.channels.hasOwnProperty(evt)){for(var args=Array.prototype.slice.call(arguments,1),a=[];this.channels[evt].length>0;){var sub=this.channels[evt].shift();"function"==typeof sub.fn&&sub.fn.apply(sub.ctx,args),sub.once||a.push(sub)}this.channels[evt]=a}}},util={flash_embed_code:function(id,swf_location,ts){var prefix,s='<param name="movie" value="'+swf_location+"?playerInstance=window."+ns+"_flash.instances['"+id+"']&datetime="+ts+'"/><param name="wmode" value="transparent"/><param name="allowscriptaccess" value="always" /></object>';return prefix=ActiveXObject?'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1" id="'+id+'">':'<object type="application/x-shockwave-flash" data="'+swf_location+"?playerInstance=window."+ns+"_flash.instances['"+id+"']&datetime="+ts+'" width="1" height="1" id="'+id+'" >',prefix+s},can_play:function(mime_type){var mime_str,a=document.createElement("audio");switch(mime_type){case"mp3":mime_str="audio/mpeg;";break;case"vorbis":mime_str='audio/ogg; codecs="vorbis"';break;case"opus":mime_str='audio/ogg; codecs="opus"';break;case"webm":mime_str='audio/webm; codecs="vorbis"';break;case"mp4":mime_str='audio/mp4; codecs="mp4a.40.5"';break;case"wav":mime_str='audio/wav; codecs="1"'}return void 0!==mime_str?"mp3"===mime_type&&navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/Firefox/i)?!0:!!a.canPlayType&&""!==a.canPlayType(mime_str):!1},has_flash:function(){var r=!1;if(navigator.plugins&&navigator.plugins.length&&navigator.plugins["Shockwave Flash"])r=!0;else if(navigator.mimeTypes&&navigator.mimeTypes.length){var mimeType=navigator.mimeTypes["application/x-shockwave-flash"];r=mimeType&&mimeType.enabledPlugin}else try{var ax=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");r="object"==typeof ax}catch(e){}return r}(),embedFlash:function(swf_location,id){var d=document.createElement("div");if(d.style.position="absolute",d.style.width="1px",d.style.height="1px",d.style.top="1px",document.body.appendChild(d),"object"==typeof $win.swfobject){var fv={playerInstance:"window."+ns+"_flash.instances['"+id+"']"},params={allowscriptaccess:"always",wmode:"transparent"};d.innerHTML='<div id="'+id+'"></div>',swfobject.embedSWF(swf_location+"?ts="+((new Date).getTime()+Math.random()),id,"1","1","9.0.0",null,fv,params)}else{var ts=(new Date).getTime()+Math.random();d.innerHTML=this.flash_embed_code(id,swf_location,ts)}return document.getElementById(id)},formatTime:function(seconds){var result,hours=parseInt(seconds/3600,10)%24,minutes=parseInt(seconds/60,10)%60,secs=parseInt(seconds%60,10),fragment=(10>minutes?"0"+minutes:minutes)+":"+(10>secs?"0"+secs:secs);return result=hours>0?(10>hours?"0"+hours:hours)+":"+fragment:fragment}};util.use_flash=util.can_play("mp3");var Audio5js,FlashAudioPlayer,HTML5AudioPlayer,AudioAttributes={playing:!1,vol:1,duration:0,position:0,load_percent:0,seekable:!1,ready:null},globalAudio5Flash=$win[ns+"_flash"]=$win[ns+"_flash"]||{instances:{},count:0};FlashAudioPlayer=function(){if(util.use_flash&&!util.has_flash)throw new Error("Flash Plugin Missing")},FlashAudioPlayer.prototype={init:function(swf_src){globalAudio5Flash.count+=1,this.id=ns+globalAudio5Flash.count,globalAudio5Flash.instances[this.id]=this,this.embed(swf_src)},embed:function(swf_src){util.embedFlash(swf_src,this.id)},eiReady:function(){this.audio=document.getElementById(this.id),this.trigger("ready")},eiLoadStart:function(){this.trigger("loadstart")},eiLoadedMetadata:function(){this.trigger("loadedmetadata")},eiCanPlay:function(){this.trigger("canplay")},eiTimeUpdate:function(position,duration,seekable){this.position=position,this.duration=duration,this.seekable=seekable,this.trigger("timeupdate",position,this.seekable?duration:null)},eiProgress:function(percent,duration,seekable){this.load_percent=percent,this.duration=duration,this.seekable=seekable,this.trigger("progress",percent)},eiLoadError:function(msg){this.trigger("error",msg)},eiPlay:function(){this.playing=!0,this.trigger("play")},eiPause:function(){this.playing=!1,this.trigger("pause")},eiEnded:function(){this.pause(),this.trigger("ended")},eiSeeking:function(){this.trigger("seeking")},eiSeeked:function(){this.trigger("seeked")},reset:function(){this.seekable=!1,this.duration=0,this.position=0,this.load_percent=0},load:function(url){this.reset(),this.audio.load(url)},play:function(){this.audio.pplay()},pause:function(){this.audio.ppause()},volume:function(v){return void 0===v||isNaN(parseInt(v,10))?this.vol:(this.audio.setVolume(v),void(this.vol=v))},seek:function(position){try{this.audio.seekTo(position),this.position=position}catch(e){}},destroyAudio:function(){this.audio&&(this.pause(),this.audio.parentNode.removeChild(this.audio),delete globalAudio5Flash.instances[this.id],delete this.audio)}},include(FlashAudioPlayer,Pubsub),include(FlashAudioPlayer,AudioAttributes),HTML5AudioPlayer=function(){},HTML5AudioPlayer.prototype={init:function(){this.trigger("ready")},createAudio:function(){this.audio=new Audio,this.audio.autoplay=!1,this.audio.preload="auto",this.audio.autobuffer=!0,this.bindEvents()},destroyAudio:function(){if(this.audio){this.pause(),this.unbindEvents();try{this.audio.setAttribute("src","")}finally{delete this.audio}}},setupEventListeners:function(){this.listeners={loadstart:this.onLoadStart.bind(this),canplay:this.onLoad.bind(this),loadedmetadata:this.onLoadedMetadata.bind(this),play:this.onPlay.bind(this),pause:this.onPause.bind(this),ended:this.onEnded.bind(this),error:this.onError.bind(this),timeupdate:this.onTimeUpdate.bind(this),seeking:this.onSeeking.bind(this),seeked:this.onSeeked.bind(this)}},bindEvents:function(){void 0===this.listeners&&this.setupEventListeners(),this.audio.addEventListener("loadstart",this.listeners.loadstart,!1),this.audio.addEventListener("canplay",this.listeners.canplay,!1),this.audio.addEventListener("loadedmetadata",this.listeners.loadedmetadata,!1),this.audio.addEventListener("play",this.listeners.play,!1),this.audio.addEventListener("pause",this.listeners.pause,!1),this.audio.addEventListener("ended",this.listeners.ended,!1),this.audio.addEventListener("error",this.listeners.error,!1),this.audio.addEventListener("timeupdate",this.listeners.timeupdate,!1),this.audio.addEventListener("seeking",this.listeners.seeking,!1),this.audio.addEventListener("seeked",this.listeners.seeked,!1)},unbindEvents:function(){this.audio.removeEventListener("loadstart",this.listeners.loadstart),this.audio.removeEventListener("canplay",this.listeners.canplay),this.audio.removeEventListener("loadedmetadata",this.listeners.loadedmetadata),this.audio.removeEventListener("play",this.listeners.play),this.audio.removeEventListener("pause",this.listeners.pause),this.audio.removeEventListener("ended",this.listeners.ended),this.audio.removeEventListener("error",this.listeners.error),this.audio.removeEventListener("timeupdate",this.listeners.timeupdate),this.audio.removeEventListener("seeking",this.listeners.seeking),this.audio.removeEventListener("seeked",this.listeners.seeked)},onLoadStart:function(){this.trigger("loadstart")},onLoad:function(){return this.audio?(this.seekable=this.audio.seekable&&this.audio.seekable.length>0,this.seekable&&(this.timer=setInterval(this.onProgress.bind(this),250)),void this.trigger("canplay")):setTimeout(this.onLoad.bind(this),100)},onLoadedMetadata:function(){this.trigger("loadedmetadata")},onPlay:function(){this.playing=!0,this.trigger("play")},onPause:function(){this.playing=!1,this.trigger("pause")},onEnded:function(){this.playing=!1,this.trigger("ended")},onTimeUpdate:function(){if(this.audio&&this.playing){try{this.position=this.audio.currentTime,this.duration=this.audio.duration===1/0?null:this.audio.duration}catch(e){}this.trigger("timeupdate",this.position,this.duration)}},onProgress:function(){this.audio&&null!==this.audio.buffered&&this.audio.buffered.length&&(this.duration=this.audio.duration===1/0?null:this.audio.duration,this.load_percent=parseInt(this.audio.buffered.end(this.audio.buffered.length-1)/this.duration*100,10),this.trigger("progress",this.load_percent),this.load_percent>=100&&this.clearLoadProgress())},onError:function(e){this.trigger("error",e)},onSeeking:function(){this.trigger("seeking")},onSeeked:function(){this.trigger("seeked")},clearLoadProgress:function(){void 0!==this.timer&&(clearInterval(this.timer),delete this.timer)},reset:function(){this.clearLoadProgress(),this.seekable=!1,this.duration=0,this.position=0,this.load_percent=0},load:function(url){this.reset(),void 0===this.audio&&this.createAudio(),this.audio.setAttribute("src",url),this.audio.load()},play:function(){this.audio.play()},pause:function(){this.audio.pause()},volume:function(v){if(void 0===v||isNaN(parseInt(v,10)))return this.vol;var vol=0>v?0:Math.min(1,v);this.audio.volume=vol,this.vol=vol},seek:function(position){var playing=this.playing;this.position=position,this.audio.currentTime=position,playing?this.play():null!==this.audio.buffered&&this.audio.buffered.length&&this.trigger("timeupdate",this.position,this.duration)}},include(HTML5AudioPlayer,Pubsub),include(HTML5AudioPlayer,AudioAttributes);var settings={swf_path:"/swf/audiojs.swf",throw_errors:!0,format_time:!0,codecs:["mp3"]};return Audio5js=function(s){s=s||{};var k;for(k in settings)settings.hasOwnProperty(k)&&!s.hasOwnProperty(k)&&(s[k]=settings[k]);this.init(s)},Audio5js.can_play=function(mime_type){return util.can_play(mime_type)},Audio5js.prototype={init:function(s){this.ready=!1,this.settings=s,this.audio=this.getPlayer(),this.bindAudioEvents(),this.settings.use_flash?this.audio.init(s.swf_path):this.audio.init()},getPlayer:function(){var i,l,player,codec;if(this.settings.use_flash)player=new FlashAudioPlayer,this.settings.player={engine:"flash",codec:"mp3"};else{for(i=0,l=this.settings.codecs.length;l>i;i++)if(codec=this.settings.codecs[i],Audio5js.can_play(codec)){player=new HTML5AudioPlayer,this.settings.use_flash=!1,this.settings.player={engine:"html",codec:codec};break}void 0===player&&(this.settings.use_flash=!Audio5js.can_play("mp3"),player=this.settings.use_flash?new FlashAudioPlayer:new HTML5AudioPlayer,this.settings.player={engine:this.settings.use_flash?"flash":"html",codec:"mp3"})}return player},bindAudioEvents:function(){this.audio.on("ready",this.onReady,this),this.audio.on("loadstart",this.onLoadStart,this),this.audio.on("loadedmetadata",this.onLoadedMetadata,this),this.audio.on("play",this.onPlay,this),this.audio.on("pause",this.onPause,this),this.audio.on("ended",this.onEnded,this),this.audio.on("canplay",this.onCanPlay,this),this.audio.on("timeupdate",this.onTimeUpdate,this),this.audio.on("progress",this.onProgress,this),this.audio.on("error",this.onError,this),this.audio.on("seeking",this.onSeeking,this),this.audio.on("seeked",this.onSeeked,this)},unbindAudioEvents:function(){this.audio.off("ready",this.onReady),this.audio.off("loadstart",this.onLoadStart),this.audio.off("loadedmetadata",this.onLoadedMetadata),this.audio.off("play",this.onPlay),this.audio.off("pause",this.onPause),this.audio.off("ended",this.onEnded),this.audio.off("canplay",this.onCanPlay),this.audio.off("timeupdate",this.onTimeUpdate),this.audio.off("progress",this.onProgress),this.audio.off("error",this.onError),this.audio.off("seeking",this.onSeeking),this.audio.off("seeked",this.onSeeked)},load:function(url){var that=this,f=function(u){that.audio.load(u),that.trigger("load")};this.ready?f(url):this.on("ready",f)},play:function(){this.playing||this.audio.play()},pause:function(){this.playing&&this.audio.pause()},playPause:function(){this[this.playing?"pause":"play"]()},volume:function(v){return void 0===v||isNaN(parseInt(v,10))?this.vol:(this.audio.volume(v),void(this.vol=v))},seek:function(position){this.audio.seek(position),this.position=position},destroy:function(){this.unbindAudioEvents(),this.audio.destroyAudio()},onReady:function(){this.ready=!0,"function"==typeof this.settings.ready&&this.settings.ready.call(this,this.settings.player),this.trigger("ready")},onLoadStart:function(){this.trigger("loadstart")},onLoadedMetadata:function(){this.trigger("loadedmetadata")},onPlay:function(){this.playing=!0,this.trigger("play")},onPause:function(){this.playing=!1,this.trigger("pause")},onEnded:function(){this.playing=!1,this.trigger("ended")},onError:function(){var error=new AudioError("Audio Error. Failed to Load Audio");if(this.settings.throw_errors)throw error;this.trigger("error",error)},onCanPlay:function(){this.trigger("canplay")},onSeeking:function(){this.trigger("seeking")},onSeeked:function(){this.trigger("seeked")},onTimeUpdate:function(position,duration){this.position=this.settings.format_time?util.formatTime(position):position,this.duration!==duration&&(this.duration=this.settings.format_time&&null!==duration?util.formatTime(duration):duration),this.trigger("timeupdate",this.position,this.duration)},onProgress:function(loaded){this.duration=this.audio.duration,this.load_percent=loaded,this.trigger("progress",loaded)}},include(Audio5js,Pubsub),include(Audio5js,AudioAttributes),Audio5js})},{}],3:[function(require,module,exports){"use strict";!function(root,factory){"function"==typeof define&&define.amd?define(factory):"undefined"!=typeof exports?module.exports=factory():root.cash=root.$=factory()}(this,function(){function find(selector,context){context=context||doc;var elems=classMatch.test(selector)?context.getElementsByClassName(selector.slice(1)):singlet.test(selector)?context.getElementsByTagName(selector):context.querySelectorAll(selector);return elems}function parseHTML(str){return frag=frag||doc.createDocumentFragment(),tmp=tmp||frag.appendChild(doc.createElement("div")),tmp.innerHTML=str,tmp.childNodes}function onReady(fn){"loading"!==doc.readyState?fn():doc.addEventListener("DOMContentLoaded",fn)}function Init(selector,context){if(!selector)return this;if(selector.cash&&selector!==win)return selector;var length,elems=selector,i=0;if(isString(selector))elems=idMatch.test(selector)?doc.getElementById(selector.slice(1)):htmlMatch.test(selector)?parseHTML(selector):find(selector,context);else if(isFunction(selector))return onReady(selector),this;if(!elems)return this;if(elems.nodeType||elems===win)this[0]=elems,this.length=1;else for(length=this.length=elems.length;length>i;i++)this[i]=elems[i];return this}function cash(selector,context){return new Init(selector,context)}function each(collection,callback){for(var l=collection.length,i=0;l>i&&callback.call(collection[i],collection[i],i,collection)!==!1;i++);}function matches(el,selector){return(el.matches||el.webkitMatchesSelector||el.mozMatchesSelector||el.msMatchesSelector||el.oMatchesSelector).call(el,selector)}function unique(collection){return cash(slice.call(collection).filter(function(item,index,self){return self.indexOf(item)===index}))}function getDataCache(node){return node[uid]=node[uid]||{}}function setData(node,key,value){return getDataCache(node)[key]=value}function getData(node,key){var c=getDataCache(node);return void 0===c[key]&&(c[key]=node.dataset?node.dataset[key]:cash(node).attr("data-"+key)),c[key]}function removeData(node,key){var c=getDataCache(node);c?delete c[key]:node.dataset?delete node.dataset[key]:cash(node).removeAttr("data-"+name)}function hasClass(v,c){return v.classList?v.classList.contains(c):new RegExp("(^| )"+c+"( |$)","gi").test(v.className)}function addClass(v,c,spacedName){v.classList?v.classList.add(c):spacedName.indexOf(" "+c+" ")&&(v.className+=" "+c)}function removeClass(v,c){v.classList?v.classList.remove(c):v.className=v.className.replace(c,"")}function compute(el,prop){return parseInt(win.getComputedStyle(el[0],null)[prop],10)||0}function registerEvent(node,eventName,callback){var eventCache=getData(node,"_cashEvents")||setData(node,"_cashEvents",{});eventCache[eventName]=eventCache[eventName]||[],eventCache[eventName].push(callback),node.addEventListener(eventName,callback)}function removeEvent(node,eventName,callback){var eventCache=getData(node,"_cashEvents")[eventName];callback?node.removeEventListener(eventName,callback):(each(eventCache,function(event){node.removeEventListener(eventName,event)}),eventCache=[])}function encode(name,value){return"&"+encodeURIComponent(name)+"="+encodeURIComponent(value).replace(/%20/g,"+")}function isCheckable(field){return"radio"===field.type||"checkbox"===field.type}function insertElement(el,child,prepend){if(prepend){var first=el.childNodes[0];el.insertBefore(child,first)}else el.appendChild(child)}function insertContent(parent,child,prepend){var str=isString(child);return!str&&child.length?void each(child,function(v){return insertContent(parent,v,prepend)}):void each(parent,str?function(v){return v.insertAdjacentHTML(prepend?"afterbegin":"beforeend",child)}:function(v,i){return insertElement(v,0===i?child:child.cloneNode(!0),prepend)})}function directCompare(el,selector){return el===selector}var frag,tmp,doc=document,win=window,ArrayProto=Array.prototype,slice=ArrayProto.slice,filter=ArrayProto.filter,push=ArrayProto.push,noop=function(){},isFunction=function(item){return typeof item==typeof noop},isString=function(item){return"string"==typeof item},idMatch=/^#[\w-]*$/,classMatch=/^\.[\w-]*$/,htmlMatch=/<.+>/,singlet=/^\w+$/,fn=cash.fn=cash.prototype=Init.prototype={constructor:cash,cash:!0,length:0,push:push,splice:ArrayProto.splice,map:ArrayProto.map,init:Init};cash.parseHTML=parseHTML,cash.noop=noop,cash.isFunction=isFunction,cash.isString=isString,cash.extend=fn.extend=function(target){target=target||{};var args=slice.call(arguments),length=args.length,i=1;for(1===args.length&&(target=this,i=0);length>i;i++)if(args[i])for(var key in args[i])args[i].hasOwnProperty(key)&&(target[key]=args[i][key]);return target},cash.extend({merge:function(first,second){for(var len=+second.length,i=first.length,j=0;len>j;i++,j++)first[i]=second[j];return first.length=i,first},each:each,matches:matches,unique:unique,isArray:Array.isArray,isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)}});var uid=cash.uid="_cash"+Date.now();fn.extend({data:function(key,value){return value?this.each(function(v){return setData(v,key,value)}):getData(this[0],key)},removeData:function(key){return this.each(function(v){return removeData(v,key)})}});var notWhiteMatch=/\S+/g;fn.extend({addClass:function(c){var classes=c.match(notWhiteMatch);return this.each(function(v){var spacedName=" "+v.className+" ";each(classes,function(c){addClass(v,c,spacedName)})})},attr:function(name,value){return value?this.each(function(v){v.setAttribute?v.setAttribute(name,value):v[name]=value}):this[0].getAttribute?this[0].getAttribute(name):this[0][name]},hasClass:function(c){var check=!1;return this.each(function(v){return check=hasClass(v,c),!check}),check},prop:function(name,value){return value?this.each(function(v){v[name]=value}):this[0][name]},removeAttr:function(name){return this.each(function(v){v.removeAttribute?v.removeAttribute(name):delete v[name]})},removeClass:function(c){var classes=c.match(notWhiteMatch);return this.each(function(v){each(classes,function(c){removeClass(v,c)})})},removeProp:function(name){return this.each(function(v){delete v[name]})},toggleClass:function(c,state){if(void 0!==state)return this[state?"addClass":"removeClass"](c);var classes=c.match(notWhiteMatch);return this.each(function(v){var spacedName=" "+v.className+" ";each(classes,function(c){hasClass(v,c)?removeClass(v,c):addClass(v,c,spacedName)})})}}),fn.extend({add:function(selector,context){return unique(cash.merge(this,cash(selector,context)))},each:function(callback){return each(this,callback),this},eq:function(index){return cash(this.get(index))},filter:function(selector){return filter.call(this,isString(selector)?function(e){return matches(e,selector)}:selector)},first:function(){return this.eq(0)},get:function(index){return void 0===index?slice.call(this):0>index?this[index+this.length]:this[index]},index:function(elem){var f=this[0];return slice.call(elem?cash(elem):cash(f).parent().children()).indexOf(f)},last:function(){return this.eq(-1)}});var getPrefixedProp=function(){function camelCase(str){return str.replace(camelRegex,function(letter,index){return letter[0===index?"toLowerCase":"toUpperCase"]()}).replace(whiteSpace,"")}var cache={},div=doc.createElement("div"),style=div.style,camelRegex=/(?:^\w|[A-Z]|\b\w)/g,whiteSpace=/\s+/g;return function(prop){if(prop=camelCase(prop),cache[prop])return cache[prop];var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),prefixes=["webkit","moz","ms","o"],props=(prop+" "+prefixes.join(ucProp+" ")+ucProp).split(" ");return each(props,function(p){return p in style?(cache[p]=prop=cache[prop]=p,!1):void 0}),cache[prop]}}();fn.extend({css:function(prop,value){if(isString(prop))return prop=getPrefixedProp(prop),value?this.each(function(v){return v.style[prop]=value}):win.getComputedStyle(this[0])[prop];for(var key in prop)this.css(key,prop[key]);return this}}),each(["Width","Height"],function(v){
var lower=v.toLowerCase();fn[lower]=function(){return this[0].getBoundingClientRect()[lower]},fn["inner"+v]=function(){return this[0]["client"+v]},fn["outer"+v]=function(margins){return this[0]["offset"+v]+(margins?compute(this,"margin"+("Width"===v?"Left":"Top"))+compute(this,"margin"+("Width"===v?"Right":"Bottom")):0)}}),fn.extend({off:function(eventName,callback){return this.each(function(v){return removeEvent(v,eventName,callback)})},on:function(eventName,delegate,callback,runOnce){var originalCallback;if(!isString(eventName)){for(var key in eventName)this.on(key,delegate,eventName[key]);return this}return isFunction(delegate)&&(callback=delegate,delegate=null),"ready"===eventName?(onReady(callback),this):(delegate&&(originalCallback=callback,callback=function(e){var t=e.target;if(matches(t,delegate))originalCallback.call(t);else{for(;!matches(t,delegate);){if(t===this)return t=!1;t=t.parentNode}t&&originalCallback.call(t)}}),this.each(function(v){var finalCallback=callback;runOnce&&(finalCallback=function(){callback.apply(this,arguments),removeEvent(v,eventName,finalCallback)}),registerEvent(v,eventName,finalCallback)}))},one:function(eventName,delegate,callback){return this.on(eventName,delegate,callback,!0)},ready:onReady,trigger:function(eventName){var evt=doc.createEvent("HTMLEvents");return evt.initEvent(eventName,!0,!1),this.each(function(v){return v.dispatchEvent(evt)})}});var formExcludes=["file","reset","submit","button"];fn.extend({serialize:function(){var formEl=this[0].elements,query="";return each(formEl,function(field){field.name&&formExcludes.indexOf(field.type)<0&&("select-multiple"===field.type?each(field.options,function(o){o.selected&&(query+=encode(field.name,o.value))}):(!isCheckable(field)||isCheckable(field)&&field.checked)&&(query+=encode(field.name,field.value)))}),query.substr(1)},val:function(value){return void 0===value?this[0].value:this.each(function(v){return v.value=value})}}),fn.extend({after:function(selector){return cash(selector).insertAfter(this),this},append:function(content){return insertContent(this,content),this},appendTo:function(parent){return insertContent(cash(parent),this),this},before:function(selector){return cash(selector).insertBefore(this),this},clone:function(){return cash(this.map(function(v){return v.cloneNode(!0)}))},empty:function(){return this.html(""),this},html:function(content){if(void 0===content)return this[0].innerHTML;var source=content.nodeType?content[0].outerHTML:content;return this.each(function(v){return v.innerHTML=source})},insertAfter:function(selector){var _this=this;return cash(selector).each(function(el,i){var parent=el.parentNode,sibling=el.nextSibling;_this.each(function(v){parent.insertBefore(0===i?v:v.cloneNode(!0),sibling)})}),this},insertBefore:function(selector){var _this2=this;return cash(selector).each(function(el,i){var parent=el.parentNode;_this2.each(function(v){parent.insertBefore(0===i?v:v.cloneNode(!0),el)})}),this},prepend:function(content){return insertContent(this,content,!0),this},prependTo:function(parent){return insertContent(cash(parent),this,!0),this},remove:function(){return this.each(function(v){return v.parentNode.removeChild(v)})},text:function(content){return content?this.each(function(v){return v.textContent=content}):this[0].textContent}});var docEl=doc.documentElement;return fn.extend({position:function(){var el=this[0];return{left:el.offsetLeft,top:el.offsetTop}},offset:function(){var rect=this[0].getBoundingClientRect();return{top:rect.top+win.pageYOffset-docEl.clientTop,left:rect.left+win.pageXOffset-docEl.clientLeft}},offsetParent:function(){return cash(this[0].offsetParent)}}),fn.extend({children:function(selector){var elems=[];return this.each(function(el){push.apply(elems,el.children)}),elems=unique(elems),selector?elems.filter(function(v){return matches(v,selector)}):elems},closest:function(selector){return!selector||matches(this[0],selector)?this:this.parent().closest(selector)},is:function(selector){if(!selector)return!1;var match=!1,comparator=isString(selector)?matches:selector.cash?function(el){return selector.is(el)}:directCompare;return this.each(function(el,i){return match=comparator(el,selector,i),!match}),match},find:function(selector){if(!selector)return cash();var elems=[];return this.each(function(el){push.apply(elems,find(selector,el))}),unique(elems)},has:function(selector){return filter.call(this,function(el){return 0!==cash(el).find(selector).length})},next:function(){return cash(this[0].nextElementSibling)},not:function(selector){return filter.call(this,function(el){return!matches(el,selector)})},parent:function(){var result=this.map(function(item){return item.parentElement||doc.body.parentNode});return unique(result)},parents:function(selector){var last,result=[];return this.each(function(item){for(last=item;last!==doc.body.parentNode;)last=last.parentElement,(!selector||selector&&matches(last,selector))&&result.push(last)}),unique(result)},prev:function(){return cash(this[0].previousElementSibling)},siblings:function(){var collection=this.parent().children(),el=this[0];return filter.call(collection,function(i){return i!==el})}}),cash})},{}],4:[function(require,module,exports){function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff),!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){"%%"!==match&&(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c),args}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{null==namespaces?storage.removeItem("debug"):storage.debug=namespaces}catch(e){}}function load(){var r;try{r=storage.debug}catch(e){}return r}function localstorage(){try{return window.localStorage}catch(e){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors;var storage;storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},{"./debug":5}],5:[function(require,module,exports){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}function enabled(){var self=enabled,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),"string"!=typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%%"===match)return match;index++;var formatter=exports.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),"function"==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn}function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;len>i;i++)split[i]&&(namespaces=split[i].replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")))}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;len>i;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;len>i;i++)if(exports.names[i].test(name))return!0;return!1}function coerce(val){return val instanceof Error?val.stack||val.message:val}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime,prevColor=0},{ms:7}],6:[function(require,module){function noop(){}function jsonp(url,opts,fn){function cleanup(){script.parentNode&&script.parentNode.removeChild(script),window[id]=noop,timer&&clearTimeout(timer)}function cancel(){window[id]&&cleanup()}"function"==typeof opts&&(fn=opts,opts={}),opts||(opts={});var script,timer,prefix=opts.prefix||"__jp",id=opts.name||prefix+count++,param=opts.param||"callback",timeout=null!=opts.timeout?opts.timeout:6e4,enc=encodeURIComponent,target=document.getElementsByTagName("script")[0]||document.head;return timeout&&(timer=setTimeout(function(){cleanup(),fn&&fn(new Error("Timeout"))},timeout)),window[id]=function(data){debug("jsonp got",data),cleanup(),fn&&fn(null,data)},url+=(~url.indexOf("?")?"&":"?")+param+"="+enc(id),url=url.replace("?&","?"),debug('jsonp req "%s"',url),script=document.createElement("script"),script.src=url,target.parentNode.insertBefore(script,target),cancel}var debug=require("debug")("jsonp");module.exports=jsonp;var count=0},{debug:4}],7:[function(require,module){function parse(str){var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}function short(ms){return ms>=d?Math.round(ms/d)+"d":ms>=h?Math.round(ms/h)+"h":ms>=m?Math.round(ms/m)+"m":ms>=s?Math.round(ms/s)+"s":ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){return n>ms?void 0:1.5*n>ms?Math.floor(ms/n)+" "+name:Math.ceil(ms/n)+" "+name+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){return options=options||{},"string"==typeof val?parse(val):options["long"]?long(val):short(val)}},{}],8:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):(global.Mustache={},factory(global.Mustache))}(this,function(mustache){function isFunction(object){return"function"==typeof object}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return null!=obj&&"object"==typeof obj&&propName in obj}function testRegExp(re,string){return regExpTest.call(re,string)}function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}function escapeHtml(string){return String(string).replace(/[&<>"'`=\/]/g,function(s){return entityMap[s]})}function parseTemplate(template,tags){function stripSpace(){if(hasTag&&!nonSpace)for(;spaces.length;)delete tokens[spaces.pop()];else spaces=[];hasTag=!1,nonSpace=!1}function compileTags(tagsToCompile){if("string"==typeof tagsToCompile&&(tagsToCompile=tagsToCompile.split(spaceRe,2)),!isArray(tagsToCompile)||2!==tagsToCompile.length)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*"),closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1])),closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}if(!template)return[];var openingTagRe,closingTagRe,closingCurlyRe,sections=[],tokens=[],spaces=[],hasTag=!1,nonSpace=!1;compileTags(tags||mustache.tags);for(var start,type,value,chr,token,openSection,scanner=new Scanner(template);!scanner.eos();){if(start=scanner.pos,value=scanner.scanUntil(openingTagRe))for(var i=0,valueLength=value.length;valueLength>i;++i)chr=value.charAt(i),isWhitespace(chr)?spaces.push(tokens.length):nonSpace=!0,tokens.push(["text",chr,start,start+1]),start+=1,"\n"===chr&&stripSpace();if(!scanner.scan(openingTagRe))break;if(hasTag=!0,type=scanner.scan(tagRe)||"name",scanner.scan(whiteRe),"="===type?(value=scanner.scanUntil(equalsRe),scanner.scan(equalsRe),scanner.scanUntil(closingTagRe)):"{"===type?(value=scanner.scanUntil(closingCurlyRe),scanner.scan(curlyRe),scanner.scanUntil(closingTagRe),type="&"):value=scanner.scanUntil(closingTagRe),!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);if(token=[type,value,start,scanner.pos],tokens.push(token),"#"===type||"^"===type)sections.push(token);else if("/"===type){if(openSection=sections.pop(),!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else"name"===type||"{"===type||"&"===type?nonSpace=!0:"="===type&&compileTags(value)}if(openSection=sections.pop())throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){for(var token,lastToken,squashedTokens=[],i=0,numTokens=tokens.length;numTokens>i;++i)token=tokens[i],token&&("text"===token[0]&&lastToken&&"text"===lastToken[0]?(lastToken[1]+=token[1],lastToken[3]=token[3]):(squashedTokens.push(token),lastToken=token));return squashedTokens}function nestTokens(tokens){for(var token,section,nestedTokens=[],collector=nestedTokens,sections=[],i=0,numTokens=tokens.length;numTokens>i;++i)switch(token=tokens[i],token[0]){case"#":case"^":collector.push(token),sections.push(token),collector=token[4]=[];break;case"/":section=sections.pop(),section[5]=token[2],collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}return nestedTokens}function Scanner(string){this.string=string,this.tail=string,this.pos=0}function Context(view,parentContext){this.view=view,this.cache={".":this.view},this.parent=parentContext}function Writer(){this.cache={}}var objectToString=Object.prototype.toString,isArray=Array.isArray||function(object){return"[object Array]"===objectToString.call(object)},regExpTest=RegExp.prototype.test,nonSpaceRe=/\S/,entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},whiteRe=/\s*/,spaceRe=/\s+/,equalsRe=/\s*=/,curlyRe=/\s*\}/,tagRe=/#|\^|\/|>|\{|&|=|!/;Scanner.prototype.eos=function(){return""===this.tail},Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(!match||0!==match.index)return"";var string=match[0];return this.tail=this.tail.substring(string.length),this.pos+=string.length,string},Scanner.prototype.scanUntil=function(re){var match,index=this.tail.search(re);switch(index){case-1:match=this.tail,this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index),this.tail=this.tail.substring(index)}return this.pos+=match.length,match},Context.prototype.push=function(view){return new Context(view,this)},Context.prototype.lookup=function(name){var value,cache=this.cache;if(cache.hasOwnProperty(name))value=cache[name];else{for(var names,index,context=this,lookupHit=!1;context;){if(name.indexOf(".")>0)for(value=context.view,names=name.split("."),index=0;null!=value&&index<names.length;)index===names.length-1&&(lookupHit=hasProperty(value,names[index])),value=value[names[index++]];else value=context.view[name],lookupHit=hasProperty(context.view,name);if(lookupHit)break;context=context.parent}cache[name]=value}return isFunction(value)&&(value=value.call(this.view)),value},Writer.prototype.clearCache=function(){this.cache={}},Writer.prototype.parse=function(template,tags){var cache=this.cache,tokens=cache[template];return null==tokens&&(tokens=cache[template]=parseTemplate(template,tags)),tokens},Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template),context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)},Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){for(var token,symbol,value,buffer="",i=0,numTokens=tokens.length;numTokens>i;++i)value=void 0,token=tokens[i],symbol=token[0],"#"===symbol?value=this.renderSection(token,context,partials,originalTemplate):"^"===symbol?value=this.renderInverted(token,context,partials,originalTemplate):">"===symbol?value=this.renderPartial(token,context,partials,originalTemplate):"&"===symbol?value=this.unescapedValue(token,context):"name"===symbol?value=this.escapedValue(token,context):"text"===symbol&&(value=this.rawValue(token)),void 0!==value&&(buffer+=value);return buffer},Writer.prototype.renderSection=function(token,context,partials,originalTemplate){function subRender(template){return self.render(template,context,partials)}var self=this,buffer="",value=context.lookup(token[1]);if(value){if(isArray(value))for(var j=0,valueLength=value.length;valueLength>j;++j)buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate);else if("object"==typeof value||"string"==typeof value||"number"==typeof value)buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate);else if(isFunction(value)){if("string"!=typeof originalTemplate)throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender),null!=value&&(buffer+=value)}else buffer+=this.renderTokens(token[4],context,partials,originalTemplate);return buffer}},Writer.prototype.renderInverted=function(token,context,partials,originalTemplate){var value=context.lookup(token[1]);return!value||isArray(value)&&0===value.length?this.renderTokens(token[4],context,partials,originalTemplate):void 0},Writer.prototype.renderPartial=function(token,context,partials){if(partials){var value=isFunction(partials)?partials(token[1]):partials[token[1]];return null!=value?this.renderTokens(this.parse(value),context,partials,value):void 0}},Writer.prototype.unescapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?value:void 0},Writer.prototype.escapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?mustache.escape(value):void 0},Writer.prototype.rawValue=function(token){return token[1]},mustache.name="mustache.js",mustache.version="2.2.1",mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function(){return defaultWriter.clearCache()},mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)},mustache.render=function(template,view,partials){if("string"!=typeof template)throw new TypeError('Invalid template! Template should be a "string" but "'+typeStr(template)+'" was given as the first argument for mustache#render(template, view, partials)');return defaultWriter.render(template,view,partials)},mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);return isFunction(send)?void send(result):result},mustache.escape=escapeHtml,mustache.Scanner=Scanner,mustache.Context=Context,mustache.Writer=Writer})},{}]},{},[1])(1)});